{"version":3,"file":"Typograph.js","sources":["../src/Keyboards.ts","../src/Sequence.ts","../src/Typograph.ts"],"sourcesContent":["function strEnum<T extends string>(o: T[]): {[K in T]: K} {\n  return o.reduce((res, key) => {\n    res[key] = key;\n    return res;\n  }, Object.create(null));\n}\n\nexport const KeyboardsNames = strEnum([\n  \"azerty\",\n  \"qwerty\",\n]);\n\nexport const keyboards: {[key in keyof typeof KeyboardsNames]: string[]} = {\n  azerty: [\"azertyuiop\", \"qsdfghjklm\", \"wxcvbn\"],\n  qwerty: [\"qwertyuiop\", \"asdfghjklz\", \"xcvbnm\"],\n};\n","interface InterfaceMistype {\n  index: number;\n  letter: string;\n}\n\nexport default class Sequence {\n\n  private text: string[];\n  private mistypeElement = document.createElement(\"mistype\");\n\n  constructor(\n    text: string,\n    private target: Element,\n    private textNode = Text.arguments,\n    private keyboard: string[],\n    private speed: number,\n    private mistype: boolean,\n    private mistypeRate: number,\n  ) {\n    this.text = Array.prototype.slice.call(text);\n  }\n\n  public async write() {\n    console.log(this.textNode);\n\n    const mistypes: InterfaceMistype[] = [];\n    while (this.text.length || mistypes.length) {\n      const rand = Math.random();\n      const speed = this.speed;\n      const mistyped = this.mistype && this.textNode!.length && rand < this.mistypeRate;\n      let element = this.target;\n\n      if (this.text.length && (mistyped || !mistypes.length)) {\n        let letter = this.text.shift()!;\n        if (mistyped) {\n          const charCode = letter.charCodeAt(0);\n          // tag = this.mistypeTag;\n          if (!this.target.querySelector(\"mistype\")) {\n            this.target.appendChild(this.mistypeElement);\n          }\n\n          mistypes.unshift({\n            index: this.textNode!.length,\n            letter,\n          });\n\n          if (charCode > 96 && charCode < 123) {\n            const keyboardLine = this.keyboard.filter((e: string) => e.indexOf(letter) >= 0).shift()!;\n            const letterPosition = keyboardLine.indexOf(letter.toLowerCase());\n            /* wrongChar = sibbling letter (ex: if t then r or y)\n            IF first or last letter of the line\n            THEN wrongChar = first letter +1 or last letter -1 (ex for qwerty: if q then w or if n then b) */\n            letter = keyboardLine[\n              letterPosition +\n              (!letterPosition ? 1 :\n                letterPosition + 1 === keyboardLine.length ? -1 : (Math.round(Math.random()) ? 1 : -1)\n              )\n            ];\n          }\n        }\n        this.textNode.nodeValue += await this.typeLetter(speed, letter);\n      } else {\n        while (mistypes.length) {\n          this.text.unshift(await this.removeLetter(speed, mistypes.shift()!));\n        }\n      }\n    }\n\n    return mistypes;\n  }\n\n  private typeLetter(t: number, letter: string): Promise<string> {\n    return new Promise((resolve: (letter: string) => void) => setTimeout(() => resolve(letter!), t));\n  }\n\n  private removeLetter(t: number, mistype: InterfaceMistype): Promise<string> {\n    return new Promise((resolve: (letter: string) => void) => setTimeout(() => {\n      this.textNode.nodeValue = this.textNode.nodeValue!.slice(0, -1);\n      resolve(mistype.letter);\n    }, t));\n  }\n}\n","import {keyboards} from \"./Keyboards\";\nimport Sequence from \"./Sequence\";\nimport InterfaceParams from \"./TypographParamsInterface\";\n\nexport default class Typograph {\n  private sequences: Sequence[] = [];\n  private params: InterfaceParams;\n\n  constructor(p: InterfaceParams) {\n    this.params = {\n      ...p,\n      mistype: !!p.mistype,\n      mistypeRate: p.mistypeRate || 0.3,\n      speed: p.speed || 250,\n    };\n  }\n\n  public type(callback?: () => void): void {\n    this.sequences = this.initSequences();\n    this.sequences.forEach((sequence: Sequence) => sequence.write());\n  }\n\n  private initSequences(): Sequence[] {\n    return Array.from(document.querySelectorAll(this.params.selector)).map((el: Element) => {\n      const sequence = new Sequence(\n        this.params.text || el.getAttribute(\"data-typeit\") || el.firstChild!.nodeValue || \"\",\n        el,\n        el.insertBefore(document.createTextNode(\"\"), el.firstChild),\n        keyboards[this.params.keyboard || \"qwerty\"],\n        this.params.speed!,\n        this.params.mistype!,\n        this.params.mistypeRate!,\n      );\n      console.log(el);\n\n      el.firstChild!.nodeValue = \"\";\n      return sequence;\n    });\n  }\n}\n"],"names":[],"mappings":"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"}